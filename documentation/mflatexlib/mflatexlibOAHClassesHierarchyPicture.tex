% -------------------------------------------------------------------------
%  MusicFormats Library
%  Copyright (C) Jacques Menu 2016-2025

%  This Source Code Form is subject to the terms of the Mozilla Public
%  License, v. 2.0. If a copy of the MPL was not distributed with this
%  file, you can obtain one at http://mozilla.org/MPL/2.0/.

%  https://github.com/jacques-menu/musicformats
% -------------------------------------------------------------------------

\begin{adjustwidth}{0.5 cm}{0.5 cm}
\begin{figure}[tpb]

%\floatbox[{\capbeside\thisfloatsetup{capbesideposition={left,top},capbesidewidth=4cm}}]{figure}[\FBwidth]

\caption {The OAH classes hierarchy}

%\begin{sidecaption}[fortoc]{title}[label]
%the body of the float
%\end{sidecaption}

\label{The OAH classes hierarchy}

\tt

\begin{center}


% The sizes
% ------------------------------------------------

\def \bendAngle {60}

\def \minimumRectangleHeight {8.5 mm}
\def \minimumRectangleWidth  {30 mm}

\def \separatorWidth {\minimumRectangleWidth}

\def \roundedCorners {10pt}


% -------------------------------------------------------------------------
\begin{tikzpicture}[
	%
	scale=0.45,
	%
	>=open triangle 45,
	%
	every node/.style={
  	rounded corners=\roundedCorners,
  	minimum height=\minimumRectangleHeight,
  	minimum width=\minimumRectangleWidth,
  	draw=black
		}
	]

% elements positions
% ------------------------------------------------

\tikzmath{
	% the absisses
  \leftColumnAbs        = -4.5 mm;
  \rightColumnAbs       = -\leftColumnAbs;
  \middleLeftColumnAbs        = -2 mm;
   \middleRightColumnAbs       = -\middleLeftColumnAbs;
%
  % the ordinates
  \oahFindableElementOrd            = 0 mm;
   %
  \oahElementOrd          = \oahFindableElementOrd -1.5 mm;
  %
  \oahHandlerAbs       	       = \leftColumnAbs;
  \oahHandlerOrd       	       = \oahElementOrd - 1.25 mm;
  %
  \verticalStep = 1mm;
  %
  \oahGroupAbs = \oahHandlerAbs * 0.37;
  \oahGroupOrd            = \oahHandlerOrd - \verticalStep;
   %
   \oahSubGroupAbs = - \oahGroupAbs;
 \oahSubGroupOrd      = \oahGroupOrd - \verticalStep;
   %
   \oahAtomAbs = - \oahHandlerAbs;
    \oahAtomOrd            = \oahSubGroupOrd - \verticalStep;
  %
  %
  \oahInsiderHandlerAbs = \leftColumnAbs - 1.6 mm;
  \oahInsiderHandlerOrd = \oahHandlerOrd - 3 mm;
  %
   \oahRegularHandlerAbs = \leftColumnAbs + 1.6 mm;
  \oahRegularHandlerOrd = \oahInsiderHandlerOrd;
  %
	\oahPrefixAbs =\leftColumnAbs - 2.5 mm;
	\oahPrefixOrd =  \oahHandlerOrd - 1.75 mm;
}



% The colors
% ------------------------------------------------

\def \SecondaryRectanglesBackgroundColor {pink!10}
\def \ElementsRectanglesBackgroundColor  {yellow!10}
\def \PrimaryRectanglesBackgroundColor   {green!7.5}
\def \RepeatRectanglesBackgroundColor    {orange!10}

\def \baseClassArcsColor {red}
\def \usedByClassArcsColor {blue}
\def \loopsColor {red}



% The coordinates
% ------------------------------------------------

\coordinate (oahFindableElement)     at (0,\oahFindableElementOrd);

\coordinate (oahPrefix)     at (\oahPrefixAbs,\oahPrefixOrd);

\coordinate (oahElement)   at (0,\oahElementOrd);

\coordinate (oahHandler)          at (\oahHandlerAbs,\oahHandlerOrd);

\coordinate (oahGroup)             at (\oahGroupAbs,\oahGroupOrd);

\coordinate (oahSubGroup)     at (\oahSubGroupAbs,\oahSubGroupOrd);

\coordinate (oahAtom)     at (\oahAtomAbs,\oahAtomOrd);


\coordinate (oahInsiderHandler)          at (\oahInsiderHandlerAbs,\oahInsiderHandlerOrd);
\coordinate (oahRegularHandler)         at (\oahRegularHandlerAbs,\oahRegularHandlerOrd);



% Draw the nodes and arcs
% ------------------------------------------------

% oahFindableElement
% ------------------------------------------------
\node [fill=\ElementsRectanglesBackgroundColor]
  (oahFindableElement) at (oahFindableElement) {\texttt {oahFindableElement}};


% oahPrefix
% ------------------------------------------------
\node [fill=\RepeatRectanglesBackgroundColor]
  (oahPrefix) at (oahPrefix) {\texttt {\textbf {oahPrefix}}};

\draw [->, thick, \baseClassArcsColor]
	(oahPrefix) ..
	controls +(150:6 cm) and +(190:6 cm) ..
    (oahFindableElement);

\draw [->, thick, \usedByClassArcsColor]
	(oahPrefix) %..
%	controls +(5:7 cm) and +(190:6.5 cm) ..
	edge node [draw=none] {}
  (oahHandler);


% oahElement
% ------------------------------------------------
\node [fill=\ElementsRectanglesBackgroundColor]
  (oahElement) at (oahElement) {\texttt {oahElement}};

\path [->, thick, \baseClassArcsColor]
	(oahElement)
  edge node [draw=none] {}
	(oahFindableElement);


% oahHandler
% ------------------------------------------------
\node [fill=\PrimaryRectanglesBackgroundColor]
  (oahHandler) at (oahHandler) {\texttt {\textbf {oahHandler}}};

\draw [->, thick, \baseClassArcsColor]
	(oahHandler) %..
%	controls +(5:7 cm) and +(190:6.5 cm) ..
	edge node [draw=none] {}
  (oahFindableElement);


% oahInsiderHandler
% ------------------------------------------------
\node [fill=\PrimaryRectanglesBackgroundColor]
  (oahInsiderHandler) at (oahInsiderHandler) {\texttt {\textbf {oahInsiderHandler}}};

\draw [->, thick, \baseClassArcsColor]
	(oahInsiderHandler) %..
%	controls +(5:7 cm) and +(190:6.5 cm) ..
	edge node [draw=none] {}
  (oahHandler);


% oahRegularHandler
% ------------------------------------------------
\node [fill=\PrimaryRectanglesBackgroundColor]
  (oahRegularHandler) at (oahRegularHandler) {\texttt {\textbf {oahRegularHandler}}};

\draw [->, thick, \baseClassArcsColor]
	(oahRegularHandler) %..
%	controls +(5:7 cm) and +(190:6.5 cm) ..
	edge node [draw=none] {}
  (oahHandler);


% oahGroup
% ------------------------------------------------
\node [fill=\PrimaryRectanglesBackgroundColor]
  (oahGroup) at (oahGroup) {\texttt {\textbf {oahGroup}}};

\draw [->, thick, \baseClassArcsColor]
	(oahGroup)
	edge node [draw=none] {}
  (oahElement);

\draw [->, thick, \usedByClassArcsColor]
	(oahGroup)
	edge node [draw=none] {}
  (oahHandler);


% oahSubGroup
% ------------------------------------------------
\node [fill=\PrimaryRectanglesBackgroundColor]
  (oahSubGroup) at (oahSubGroup) {\texttt {\textbf {oahSubGroup}}};

\draw [->, thick, \baseClassArcsColor]
	(oahSubGroup) %..
	edge node [draw=none] {}
%	controls +(170:6 cm) and +(320:3) ..
  (oahElement);

\draw [->, thick, \usedByClassArcsColor]
	(oahSubGroup)
	edge node [draw=none] {}
  (oahGroup);


% oahAtom
% ------------------------------------------------
\node [fill=\PrimaryRectanglesBackgroundColor]
  (oahAtom) at (oahAtom) {\texttt {\textbf {oahAtom}}};

\draw [->, thick, \baseClassArcsColor]
	(oahAtom) %..
%	controls +(170:6 cm) and +(320:3) ..
	edge node [draw=none] {}
  (oahElement);

\draw [->, thick, \usedByClassArcsColor]
	(oahAtom)
	edge node [draw=none] {}
  (oahSubGroup);


% -------------------------------------------------------------------------
\end{tikzpicture}
 % -------------------------------------------------------------------------

\end{center}

\end{figure}
\end{adjustwidth}

