% -------------------------------------------------------------------------
%  MusicFormats Library
%  Copyright (C) Jacques Menu 2016-2024

%  This Source Code Form is subject to the terms of the Mozilla Public
%  License, v. 2.0. If a copy of the MPL was not distributed with this
%  file, you can obtain one at http://mozilla.org/MPL/2.0/.

%  https://github.com/jacques-menu/musicformats
% -------------------------------------------------------------------------

% !TEX root = mfmaintainanceguide.tex

% -------------------------------------------------------------------------
\chapter{LilyPond Scores Representation (LPSR)}
% -------------------------------------------------------------------------


An LPSR description contains two components:
\begin{itemize}
\item the first one is an MSR, thus the whole music score description;
\item the second one is a description of the structure of the score mirroring \lily's specific blocks such as \lilycmd {book} and \lilycmd {layout}.
\end{itemize}

\Class{lpsrScore} thus contains:
\begin{lstlisting}[language=CPlusPlus]
    // MSR data
    S_msrScore            fMsrScore;

		// ... ... ...

    // LilyPond stuff
    S_lpsrHeader          fScoreHeader;
    S_lpsrPaper           fScorePaper;
    S_lpsrLayout          fScoreLayout;

    // variables, voices and stanzas
    std::list<S_msrElement>
                          fScoreElementsList;

    // score LPSR book blocks list
    std::list<S_lpsrBookBlock> fScoreBookBlocksList;
    S_lpsrScoreBlock      fScoreScoreBlock; // JMI ???
\end{lstlisting}

% -------------------------------------------------------------------------
\section{LPSR basic types}\label{LPSR basic types}
% -------------------------------------------------------------------------

Some types used thoughout \lpsrRepr\ are defined in \lpsrBoth{lpsrEnumTypes}:%%%JMI
\begin{lstlisting}[language=Terminal]
jacquesmenu@macmini: ~/musicformats-git-dev/src/formats/lpsr >  egrep -rIn  '^// ' lpsrEnumTypes.h
lpsrEnumTypes.h:28:// score output kinds
lpsrEnumTypes.h:50:// accidental styles
lpsrEnumTypes.h:53:// JMI there are new ones in LilyPond 2.22
lpsrEnumTypes.h:87:// chords languages
lpsrEnumTypes.h:107:// whole notes
lpsrEnumTypes.h:118:// dotted durations
lpsrEnumTypes.h:129:// rests measures
lpsrEnumTypes.h:135:// texts lists
lpsrEnumTypes.h:141:// pitches and octaves
lpsrEnumTypes.h:151:// lyrics durations
lpsrEnumTypes.h:168:// initialization
\end{lstlisting}


% -------------------------------------------------------------------------
\section{Adapting LilyPond code generation to the target version number}
% -------------------------------------------------------------------------

%%%JMI
As of version 2.22, {\tt compressMultiMeasureRests} has been replaced by {\tt compressMeasureRests} for clarity.

Such is done specific methods:
\begin{lstlisting}[language=CPlusPlus]

\end{lstlisting}
