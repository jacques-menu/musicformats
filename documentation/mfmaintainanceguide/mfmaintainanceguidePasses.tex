% -------------------------------------------------------------------------
%  MusicFormats Library
%  Copyright (C) Jacques Menu 2016-2023

%  This Source Code Form is subject to the terms of the Mozilla Public
%  License, v. 2.0. If a copy of the MPL was not distributed with this
%  file, you can obtain one at http://mozilla.org/MPL/2.0/.

%  https://github.com/jacques-menu/musicformats
% -------------------------------------------------------------------------

% !TEX root = mfmaintainanceguide.tex

% -------------------------------------------------------------------------
\chapter{The passes}
% -------------------------------------------------------------------------

A pass performs a single translation from one music score description into another, such as from \mxml\ to an \mxsrRepr, or from an \mxsrRepr\ to an \msrRepr. The name 'pass' comes from the compiler writing field.


% -------------------------------------------------------------------------
\section{Translating MusicXML data to an MXSR format}
% -------------------------------------------------------------------------

This is supplied by the \libmusicxml\ library, a version of which is distributed as part of \mf\ to avoid the need of two installs and the potential associated problems.


% -------------------------------------------------------------------------
\subsection{MusicXML coverage}\label{MusicXML coverage}
% -------------------------------------------------------------------------

\mxsrToMsrBoth{mxsr2msrSkeletonBuilder} and \msrToMxsrBoth{msr2mxsrTranslator} handle most of the \mxml\ version 3.1 elements. Some of them are handled by both sub-passes, such as {\tt S_voice}, {\tt S_measure} and {\tt S_harmony}.

Among the elements that \mf\ does not handled are the ones for which there is no occurrence in the corpus in folder {\tt files/musicxml}, such as {\tt beat-unit-tied} and {\tt metronome-tied}.

The elements that are new in \mxml\ version 4.0 are not known nor handled yet as of this writing.


% -------------------------------------------------------------------------
\subsection{{\tt Backup} and {\tt forward handling}}\label{{Backup} and {forward handling}}
% -------------------------------------------------------------------------

These markups move the '\mxml\ \drawing\ point' left and right. \Class{mxsr2msrTranslator} does this this way:
\begin{lstlisting}[language=CPlusPlus]

\end{lstlisting}



% -------------------------------------------------------------------------
\section{Translating an MXSR to an MSR}
% -------------------------------------------------------------------------

This is done by \class{mxsr2msrTranslator}.


% -------------------------------------------------------------------------
\section{Translating an MSR to an MXSR}
% -------------------------------------------------------------------------


% -------------------------------------------------------------------------
\section{Translating an MSR to another MSR}
% -------------------------------------------------------------------------

Such translation is meant to offer an opportunity to modify the score's description depending on options.


% -------------------------------------------------------------------------
\section{Translating an MSR to an LPSR}
% -------------------------------------------------------------------------

This converter embeds a specific converter of MSR to MSR, to circumvent the famous \lily\ issue \#34.


% -------------------------------------------------------------------------
\section{Translating an LPSR to LilyPond code}
% -------------------------------------------------------------------------

%%%JMI



There are two visiting trace options for the generation of LilyPond code, one for its MSR component, and the other one for its LPSR own part:
\begin{lstlisting}[language=CPlusPlus]
// %%%JMI    Bool                  fGenerateMsrVisitingInformation;
    Bool                  fGenerateLpsrVisitingInformation;
\end{lstlisting}


% -------------------------------------------------------------------------
\section{Translating an MSR to an BSR}
% -------------------------------------------------------------------------

This converter embeds a specific converter of MSR to MSR, to circumvent the famous \lily\ issue \#34.


% -------------------------------------------------------------------------
\section{Translating a BSR to another BSR}
% -------------------------------------------------------------------------


% -------------------------------------------------------------------------
\section{Translating an MXSR to Guido}
% -------------------------------------------------------------------------


