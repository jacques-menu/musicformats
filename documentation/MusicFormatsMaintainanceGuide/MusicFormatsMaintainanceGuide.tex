% MusicFormats maintainance guide
% Jacques Menu, 2021-2022

\documentclass[11pt,a4paper]{report}


% -------------------------------------------------------------------------
% import common LaTeX settings
% -------------------------------------------------------------------------

\usepackage{import}

\subimport{../CommonLaTeXFiles}{CommonSettings.tex}

\subimport{../CommonLaTeXFiles}{DivisionsCommands.tex}

\subimport{../CommonLaTeXFiles}{Indexing.tex}

\subimport{../CommonLaTeXFiles}{FontsAndColors.tex}

\subimport{../CommonLaTeXFiles}{Referencing.tex}

\subimport{../CommonLaTeXFiles}{Boxes.tex}

\subimport{../CommonLaTeXFiles}{GraphicsAndPictures.tex}

\subimport{../CommonLaTeXFiles}{MusicFormatsCommands.tex}

\subimport{../CommonLaTeXFiles}{MusicFormatsFilesAndFolders.tex}

\subimport{../CommonLaTeXFiles}{MusicFormatsNames.tex}

\subimport{../CommonLaTeXFiles}{Shortcuts.tex}

\subimport{../CommonLaTeXFiles}{Listings.tex}

\subimport{../CommonLaTeXFiles}{TablesAndLists.tex}


% -------------------------------------------------------------------------
% indexing (specific to this document)
% -------------------------------------------------------------------------

\makeindex[name=Main, options= -s ../CommonLaTeXFiles/MusicFormats.ist, columns=2, title=Main index, intoc]
%\makeindex[columns=2, title=Index, intoc]
% typically, \printindex is placed at the end of the document
% https://mirror.foobar.to/CTAN/macros/latex/contrib/imakeidx/imakeidx.pdf
% https://fr.overleaf.com/learn/latex/Indices
% https://fr.overleaf.com/learn/latex/Indices#Reference_guide

% JMI don't create too many indexes, this causes idxlayout not to produce any indexes at all!

\makeindex[name=Files, options= -s ../CommonLaTeXFiles/MusicFormats.ist, columns=2, title=Files index, intoc]

\makeindex[name=Types, options= -s ../CommonLaTeXFiles/MusicFormats.ist, columns=2, title=Types index, intoc]

\makeindex[name=MethodsAndFields, options= -s ../CommonLaTeXFiles/MusicFormats.ist, columns=2, title=Methods and fields index, intoc]

\makeindex[name=ConstantsFunctionsAndVariables, options= -s ../CommonLaTeXFiles/MusicFormats.ist, columns=2, title={Constants, functions and variables index}, intoc]

\makeindex[name=Options, options= -s ../CommonLaTeXFiles/MusicFormats.ist, columns=2, title=Options, intoc]

\makeindex[name=MusicXML, options= -s ../CommonLaTeXFiles/MusicFormats.ist, columns=2, title=MusicXML index, intoc]

\indexsetup{level=\section}


%\usepackage{cleveref}
	% http://tug.ctan.org/tex-archive/macros/latex/contrib/cleveref/cleveref.pdf


% -------------------------------------------------------------------------
\begin{document}
% -------------------------------------------------------------------------

\useFirstPageHeadersAndFooters

% defeat headwidth not being equal to \textwidth %%%JMI should not be necessary ???
\setlength{\headwidth}{\textwidth}

% use the lists fancyhead headers and footers
\useListsPagesHeadersAndFooters


\begin{titlepage}
  \begin{center}
    \vspace*{2cm}

    \textbf{
      \LARGE{\mf\ maintainance guide} \\[10pt]
			\Large{\url{https://github.com/jacques-menu/musicformats}}
			}

    \vspace{0.25cm}

    \large{
    	\input{../../MusicFormatsVersionNumber.txt}%
			-- %
    	\input{../../MusicFormatsVersionDate.txt}
		}

    \vspace{0.75cm}

    \large{\textbf{Jacques Menu}}

  \end{center}

  \vspace{1cm}

This document presents the internal working of \mf. It is part of the \mf\ documentation, to be found at \url{https://github.com/jacques-menu/musicformats/tree/dev/documentation}.

\begin{center}
\begin{turn}{1}
\maxsizebox{0.9\linewidth}{5cm}{
\begin{minipage}{\linewidth}
\begin{lstlisting}[language=Terminal]
void msrSegment::browseData (basevisitor* v)
{
	// ... ... ...

  for (
    std::list<S_msrMeasure>::const_iterator i = fSegmentElementsList.begin ();
    i != fSegmentElementsList.end ();
    ++i
  ) {
    // browse the element
    msrBrowser<msrMeasure> browser (v);
    browser.browse (*(*i));
  } // for

	// ... ... ...
}\end{lstlisting} % no line break here
\end{minipage}
}
\end{turn}

    \vspace{1.5cm}

\begin{turn}{-1}
\maxsizebox{0.9\linewidth}{5cm}{
\begin{minipage}{\linewidth}
\begin{lstlisting}[language=Terminal]
void msr2msrTranslator::visitStart (S_msrClef& elt)
{
#ifdef MF_TRACING_IS_ENABLED
  if (gGlobalMsrOahGroup->getTraceMsrVisitors ()) {
    gLogStream <<
      "--> Start visiting msrClef" <<
      ", line " << elt->getInputLineNumber () <<
      std::endl;
  }
#endif

  fCurrentVoiceClone->
    appendClefToVoice (elt);
}\end{lstlisting} % no line break here
\end{minipage}
}
\end{turn}

  \vfill

  \end{center}
\end{titlepage}

{
	% reduce font size for tables and lists
	\small

	% reduce vertical size of tables and lists
  \setlength {\parskip} {0.3ex plus \baselineskip minus 2pt}

  \listoffigures

  \lstlistoflistings

  \tableofcontents
}


% -------------------------------------------------------------------------
\part{Overview of MusicFormats}
% -------------------------------------------------------------------------


% now we can switch to the regular headers and footers
\useRegularPagesHeadersAndFooters


\subimport{./}{introduction.tex}

\subimport{./}{documentation.tex}

\subimport{./}{buildingMusicFormats.tex}

\subimport{./}{codeBaseStructure.tex}

\subimport{./}{components.tex}

\subimport{./}{clisamples.tex}

\subimport{./}{WAE.tex}

\subimport{./}{traceFacility.tex}

\subimport{./}{multiLingualSupport.tex}

\subimport{./}{textualInputAndOutput.tex}

\subimport{./}{binaryDataOutput.tex}

\subimport{./}{CPUMeasurements.tex}


% -------------------------------------------------------------------------
\part{Programming style and conventions}
% -------------------------------------------------------------------------

\subimport{./}{programmingStyleAndConventions.tex}


% -------------------------------------------------------------------------
\part{The two-phase visitors pattern}
% -------------------------------------------------------------------------

\subimport{./}{twoPhaseVisitorsPattern.tex}


% -------------------------------------------------------------------------
\part{MusicFormats components}
% -------------------------------------------------------------------------

\subimport{./}{MFC.tex}


% -------------------------------------------------------------------------
\part{Options and help}
% -------------------------------------------------------------------------

\subimport{./}{OAH.tex}


% -------------------------------------------------------------------------
\part{Representations}
% -------------------------------------------------------------------------

\subimport{./}{representationsGeneralPrinciples.tex}

\subimport{./}{displayingRepresentations.tex}

\subimport{./}{MSR.tex}

\subimport{./}{msrTimeOrientedRepresentation.tex}

\subimport{./}{pathToVoice.tex}

\subimport{./}{LPSR.tex}

\subimport{./}{BSR.tex}

\subimport{./}{MXSR.tex}


% -------------------------------------------------------------------------
\part{Passes}
% -------------------------------------------------------------------------

\subimport{./}{passes.tex}

\subimport{./}{lilypondGeneration.tex}

\subimport{./}{brailleGeneration.tex}

\subimport{./}{musicxmlGeneration.tex}

\subimport{./}{guidoGeneration.tex}


% -------------------------------------------------------------------------
\part{Generators}
% -------------------------------------------------------------------------

\subimport{./}{generators.tex}


% -------------------------------------------------------------------------
\part{Converters}
% -------------------------------------------------------------------------

\subimport{./}{converters.tex}


% -------------------------------------------------------------------------
\part{Interfaces}
% -------------------------------------------------------------------------

\subimport{./}{libraryInterfaces.tex}

\subimport{./}{representationsInterfaces.tex}

\subimport{./}{passesInterfaces.tex}

\subimport{./}{convertersInterfaces.tex}


% -------------------------------------------------------------------------
\part{Distributions and versions}
% -------------------------------------------------------------------------

\subimport{./}{distributions.tex}

\subimport{./}{creatingVersions.tex}


% -------------------------------------------------------------------------
\part{Selected topics}
% -------------------------------------------------------------------------

% initializations
% -------------------------------------------------------------------------

\subimport{./}{initializations.tex}


% the OAH atoms collection
% -------------------------------------------------------------------------

\subimport{./}{theOAHAtomsCollection.tex}


% MSR
% -------------------------------------------------------------------------

\subimport{./}{measuresHandling.tex}

\subimport{./}{finalizations.tex}

\subimport{./}{temposHandling.tex}

\subimport{./}{notesHandling.tex}

\subimport{./}{segmentsHandling.tex}

\subimport{./}{beatRepeatsHandling.tex}

\subimport{./}{measureRepeatsHandling.tex}

\subimport{./}{multipleFullBarRestsHandling.tex}

\subimport{./}{repeatsHandling.tex}

\subimport{./}{voicesHandling.tex}

\subimport{./}{stavesHandling.tex}

\subimport{./}{partsHandling.tex}

\subimport{./}{partGroupsHandling.tex}

\subimport{./}{scoresHandling.tex}

\subimport{./}{booksHandling.tex}

\subimport{./}{ornamentsHandling.tex}

\subimport{./}{tiesHandling.tex}

\subimport{./}{dynamicsHandling.tex}

\subimport{./}{beamsHandling.tex}

\subimport{./}{slursHandling.tex}

\subimport{./}{graceNotesGroupsHandling.tex}

\subimport{./}{chordsHandling.tex}

\subimport{./}{tupletsHandling.tex}

\subimport{./}{harmoniesHandling.tex}

\subimport{./}{figuredBassesHandling.tex}

\subimport{./}{lyricsHandling.tex}

\subimport{./}{MIDIHandling.tex}


% -------------------------------------------------------------------------
\part{MusicFormats Scripting Language (MFSL)}
% -------------------------------------------------------------------------

\subimport{./}{MFSL.tex}


% -------------------------------------------------------------------------
\part{Music Scores Description Language (MSDL)}
% -------------------------------------------------------------------------

\subimport{./}{MSDL.tex}


% -------------------------------------------------------------------------
\part{Debugging}
% -------------------------------------------------------------------------

\subimport{./}{debugging.tex}


% -------------------------------------------------------------------------
% postamble
% -------------------------------------------------------------------------

% -------------------------------------------------------------------------
\part{Indexes}
% -------------------------------------------------------------------------

%%%JMI There are several thematic indexes apart from the main, alphabetical one, to provide rich cross-indexing in this document.

% back to the lists fancyhead headers and footers
\useListsPagesHeadersAndFooters

\printindex[Files]

\printindex[Types]
\printindex[MethodsAndFields]

\printindex[ConstantsFunctionsAndVariables]

\printindex[Options]

\printindex[MusicXML]

\printindex[Main]


% -------------------------------------------------------------------------
\end{document}
% -------------------------------------------------------------------------
